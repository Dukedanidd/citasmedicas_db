{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///home/senorbuen0/ISC/sem6/bd/proyecto/citasmedicas_db/database/connection.js"],"sourcesContent":["const mysql = require('mysql2');\n\n// Configuración de la conexión\nconst connection = mysql.createConnection({\n    host: 'localhost',      // Host de la base de datos\n    port: 3306,\n    user: 'clinica-admin',          // Usuario de MySQL\n    password: 'admin',          // Contraseña de MySQL\n    database: 'clinica_db' // Nombre de la base de datos\n});\n\n// Probar la conexión\nconnection.connect((err) => {\n    if (err) {\n        console.error('Error al conectar a la base de datos:', err);\n        return;\n    }\n    console.log('Conexión exitosa a la base de datos MySQL');\n});\n\n// Exportar la conexión para usarla en otros archivos\nmodule.exports = connection; "],"names":[],"mappings":"AAAA,MAAM;AAEN,+BAA+B;AAC/B,MAAM,aAAa,MAAM,gBAAgB,CAAC;IACtC,MAAM;IACN,MAAM;IACN,MAAM;IACN,UAAU;IACV,UAAU,aAAa,6BAA6B;AACxD;AAEA,qBAAqB;AACrB,WAAW,OAAO,CAAC,CAAC;IAChB,IAAI,KAAK;QACL,QAAQ,KAAK,CAAC,yCAAyC;QACvD;IACJ;IACA,QAAQ,GAAG,CAAC;AAChB;AAEA,qDAAqD;AACrD,OAAO,OAAO,GAAG"}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 167, "column": 0}, "map": {"version":3,"sources":["file:///home/senorbuen0/ISC/sem6/bd/proyecto/citasmedicas_db/libs/auth.js"],"sourcesContent":["import connection from '../database/connection';\n\nexport async function authenticateUser(email, password) {\n    console.log('[AUTH] Iniciando autenticación para:', email);\n\n    try {\n        // Buscamos en la tabla usuarios\n        console.log('[AUTH] Ejecutando consulta SQL...');\n        const [users] = await connection.promise().query(\n            `SELECT u.user_id as id, u.email, u.password, r.nombre as rol \n             FROM usuarios u \n             JOIN roles r ON u.role_id = r.role_id \n             WHERE u.email = ? AND u.password = ?`,\n            [email, password]\n        );\n\n        console.log('[AUTH] Resultado de la consulta:', users);\n\n        if (!users || users.length === 0) {\n            console.log('[AUTH] Credenciales incorrectas para:', email);\n            return { error: 'Credenciales incorrectas' };\n        }\n\n        const user = users[0];\n\n        // No enviar la contraseña al cliente\n        const { password: _, ...userWithoutPassword } = user;\n\n        console.log('[AUTH] Usuario autenticado:', userWithoutPassword);\n\n        return {\n            user: userWithoutPassword,\n            redirectTo: getRedirectPath(user.rol)\n        };\n    } catch (error) {\n        console.error('[AUTH] Error en la autenticación:', error);\n        return { error: 'Error en la autenticación' };\n    }\n}\n\nfunction getRedirectPath(rol) {\n    switch (rol.toLowerCase()) {\n        case 'admin':\n            return '/dashboard/admin';\n        case 'doctor':\n            return '/dashboard/doctor';\n        case 'paciente':\n            return '/dashboard/patient';\n        default:\n            return '/';\n    }\n}\n"],"names":[],"mappings":";;;AAAA;;AAEO,eAAe,iBAAiB,KAAK,EAAE,QAAQ;IAClD,QAAQ,GAAG,CAAC,wCAAwC;IAEpD,IAAI;QACA,gCAAgC;QAChC,QAAQ,GAAG,CAAC;QACZ,MAAM,CAAC,MAAM,GAAG,MAAM,wHAAA,CAAA,UAAU,CAAC,OAAO,GAAG,KAAK,CAC5C,CAAC;;;iDAGoC,CAAC,EACtC;YAAC;YAAO;SAAS;QAGrB,QAAQ,GAAG,CAAC,oCAAoC;QAEhD,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG;YAC9B,QAAQ,GAAG,CAAC,yCAAyC;YACrD,OAAO;gBAAE,OAAO;YAA2B;QAC/C;QAEA,MAAM,OAAO,KAAK,CAAC,EAAE;QAErB,qCAAqC;QACrC,MAAM,EAAE,UAAU,CAAC,EAAE,GAAG,qBAAqB,GAAG;QAEhD,QAAQ,GAAG,CAAC,+BAA+B;QAE3C,OAAO;YACH,MAAM;YACN,YAAY,gBAAgB,KAAK,GAAG;QACxC;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,qCAAqC;QACnD,OAAO;YAAE,OAAO;QAA4B;IAChD;AACJ;AAEA,SAAS,gBAAgB,GAAG;IACxB,OAAQ,IAAI,WAAW;QACnB,KAAK;YACD,OAAO;QACX,KAAK;YACD,OAAO;QACX,KAAK;YACD,OAAO;QACX;YACI,OAAO;IACf;AACJ"}},
    {"offset": {"line": 218, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["file:///home/senorbuen0/ISC/sem6/bd/proyecto/citasmedicas_db/app/api/auth/login/route.js"],"sourcesContent":["import { authenticateUser } from '@/libs/auth';\nimport { NextResponse } from 'next/server';\n\nexport async function POST(request) {\n    try {\n        const body = await request.json();\n        const { email, password } = body;\n\n        if (!email || !password) {\n            return NextResponse.json(\n                { error: 'Correo y contraseña son requeridos' },\n                { status: 400 }\n            );\n        }\n\n        const result = await authenticateUser(email, password);\n\n        if (result.error) {\n            return NextResponse.json(\n                { error: result.error },\n                { status: 401 }\n            );\n        }\n\n        return NextResponse.json(result);\n    } catch (error) {\n        console.error('Error en el login:', error);\n        return NextResponse.json(\n            { error: 'Error en el servidor' },\n            { status: 500 }\n        );\n    }\n} "],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAO;IAC9B,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG;QAE5B,IAAI,CAAC,SAAS,CAAC,UAAU;YACrB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACpB;gBAAE,OAAO;YAAqC,GAC9C;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,SAAS,MAAM,CAAA,GAAA,8GAAA,CAAA,mBAAgB,AAAD,EAAE,OAAO;QAE7C,IAAI,OAAO,KAAK,EAAE;YACd,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACpB;gBAAE,OAAO,OAAO,KAAK;YAAC,GACtB;gBAAE,QAAQ;YAAI;QAEtB;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACpB;YAAE,OAAO;QAAuB,GAChC;YAAE,QAAQ;QAAI;IAEtB;AACJ"}},
    {"offset": {"line": 268, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}